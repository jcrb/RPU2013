Diagnostic principal
========================================================
On récupère la colonne diagnostic principal

```{r init,cache=TRUE,echo=TRUE}
#'@param dp liste brute des diagnostics
#'@param dpr liste des diag sans les NA. Les intitulés sont standardisés par suppression du point. Ainsi I60.9 devient I609 (méthode gsub)
#'@param ndp nombre de DP bruts (NA inclus)
#'@param ndpr nombre de DP renseignés

library("epicalc")
library("lubridate")

load("../../rpu2013d0107.Rda")
d1<-d0107
rm(d0107)
dp<-d1$DP
ndp<-length(dp)
dpr<-dp[!is.na(dp)]
dpr<-gsub(".","",dpr,fixed=TRUE)

```
Nombre de diagnostics principaux (DP)
```{rdp,echo=TRUE}
ndpr<-length(dpr)
ndpr
```
Exhaustivité
```{r}
ex<-round(ndpr * 100/ndp,2)
ex
```
Nombre de diagnostic uniques:
```{r}
a<-length(unique(dpr))
a
a<-substr(dpr,1,1)
tab1(a,horiz=T,sort.group="decreasing",main="Classes dignostiques de la CIM10")
```

Etude des AVC
-------------
Les AVC sont définis par la nomenclature *I60* à *I64*, *G45* Accidents ischémiques cérébraux transitoires (sauf G45.4 amnésie transitoire) et syndromes apparentés et *G46* Syndromes vasculaires cérébraux au cours de maladies cérébrovasculaires

La prévention et la prise en charge des accidents vasculaires cérébraux - Annexes -
juin 2009

Annexe : Liste exhaustive des codes CIM-10 d’AVC

- G450 Syndrome vertébro-basilaire
- G451 Syndrome carotidien (hémisphérique)
- G452 Accident ischémique transitoire de territoires artériels précérébraux multipleset bilatéraux
- G453 Amaurose fugace
- G454 Amnésie globale transitoire : NON RETENU
- G458 Autres accidents ischémiques cérébraux transitoires et syndromes apparentés
- G459 Accident ischémique cérébral transitoire, sans précision
- I600 Hémorragie sous-arachnoïdienne de labifurcation et du siphon carotidien
- I601 Hémorragie sous-arachnoïdienne de l'artère cérébrale moyenne
- I602 Hémorragie sous-arachnoïdienne de
- l'artère communicante antérieure
- I603 Hémorragie sous-arachnoïdienne del'artère communicante postérieure
- I604 Hémorragie sous-arachnoïdienne de l'artère basilaire
- I605 Hémorragie sous-arachnoïdienne de l'artère vertébrale
- I606 Hémorragie sous-arachnoïdienne d'autres artères intracrâniennes
- I607 Hémorragie sous-arachnoïdienne d'une ar
tère intracrânienne, sans précision
- I608 Autres hémorragies sous-arachnoïdiennes
- I609 Hémorragie sous-arachnoïdienne, sans précision
- I610 Hémorragie intracérébrale hémisphérique, sous-corticale
- I611 Hémorragie intracérébrale hémisphérique, corticale
- I612 Hémorragie intracérébrale hémisphérique, non précisée
- I613 Hémorragie intracérébrale du tronc cérébral
- I614 Hémorragie intracérébrale cérébelleuse
- I615 Hémorragie intracérébrale intraventriculaire
- I616 Hémorragie intracérébrale,localisations multiples
- I618 Autres hémorragies intracérébrales
- I619 Hémorragie intracérébrale, sans précision
- I620 Hémorragie sous-durale (aiguë) (non traumatique)
- I621 Hémorragie extradurale non traumatique
- I629 Hémorragie intracrânienne (non traumatique), sans précision
- I630 Infarctus cérébral dû à une thrombose des artères précérébrales
- I631 Infarctus cérébral dû à une embolie des artères précérébrales
- I632 Infarctus cérébral dû à une occlusion ou sténose des artères précérébrales,de mécanisme non précisé
- I633 Infarctus cérébral dû à une thrombose des artères cérébrales
- I634 Infarctus cérébral dû à une embolie des artères cérébrales
- I635 Infarctus cérébral dû à une occlusion ou sténose des artères cérébrales, demécanisme non précisé
- I636 Infarctus cérébral dû à une thrombose veineuse cérébrale, non pyogène
- I638 Autres infarctus cérébraux
- I639 Infarctus cérébral, sans précision
- I64 Accident vasculaire cérébral, non précisé comme étant hémorragique ou parinfarctus
- G460 Syndrome de l'artère cérébrale moyenne (I66.0) (1)
- G461 Syndrome de l'artère cérébrale antérieure (I66.1) (1)
- G462 Syndrome de l'artère cérébrale postérieure (I66.2) (1)
- G463 Syndromes vasculaires du tronc cérébral (I60-I67) (1)
- G464 Syndrome cérébelleux vasculaire (I60-I67) (1)
- G465 Syndrome lacunaire moteur pur (I60-I67) (1)
- G466 Syndrome lacunaire sensitif pur (I60-I67) (1)
- G467 Autres syndromes lacunaires (I60-I67) (1)
- G468 Autres syndromes vasculaires cérébraux au cours de maladies cérébrovasculaires (I60-I67) (1)
(1) : résumé à ne retenir que si présence d’un diagnostic associé significatif (DAS) des catégories I60 à I64

```{r avc,echo=FALSE}
#'@param avc liste des AVC
#'@param navc liste des codes Cim10 utilisés

avc<-dpr[substr(dpr,1,3)>="I60" & substr(dpr,1,3)<"I65" | substr(dpr,1,3)=="G46"]
navc<-unique(avc)
summary(as.factor(avc))

tab1(avc,horiz=TRUE,sort.group="decreasing",main="AVC aux urgences (hors filière UNV",missing=FALSE)
```
# Etude des AVC+AIT

avc_ait<-dpr[substr(dpr,1,3)>="I60" & substr(dpr,1,3)<"I65" | substr(dpr,1,3)=="G46" | substr(dpr,1,3)=="G45"]

tab1(avc_ait,horiz=TRUE,sort.group="decreasing",main="AVC&AIT aux urgences (hors filière UNV",missing=FALSE)

# Création d'un dataframe DP

```{r df_avc,echo=FALSE}
dpr<-d1[!is.na(d1$DP),c("DP","CODE_POSTAL","ENTREE","FINESS","GRAVITE","ORIENTATION","MODE_SORTIE","AGE","SEXE","TRANSPORT")]
# un peu de ménage:
dpr$DP<-gsub(".","",as.character(dpr$DP),fixed=TRUE)
dpr$DP<-gsub("+","",as.character(dpr$DP),fixed=TRUE)
```
extraction d'un DF avc:
```{r}
AVC<-dpr[substr(dpr$DP,1,3)>="I60" & substr(dpr$DP,1,3)<"I65" | substr(dpr$DP,1,3)=="G46" | substr(dpr$DP,1,3)=="G45" ,]
```
Horaire des AVC  
à comparer avec
- les crises d'épilepsie
- la pression athmosphérique

```{r heure_avc,echo=FALSE}
h<-hour(AVC$ENTREE)
hist(h,breaks=24,xlab="Heure de la journée",main="Répartition des AVC dans la journée")
tab1(h,missing=FALSE,main="Heures d'admission des AVC")
```
Selon le jour de la semaine

```{r avc_semaine,echo=FALSE}
w<-wday(AVC$ENTREE,label=TRUE)
table(w)
round( prop.table(table(w))*100,2)
plot(w,main="AVC selon le jour de la semaine")
abline(h=nrow(AVC)/7,col="red")
```
Proportion théorique = 14.28% par jour de la semaine

Age et AVC
----------
```{r avc_age,echo=FALSE}
summary(AVC$AGE)
```
Le rapport de 2009 donne age moyen = 70.5 et age médian = 75 ans.

Sexe et AVC
-----------
```{r avc_sexe}
summary(AVC$SEXE)
hist(AVC$AGE,main="Répartition des AVC",col="pink",xlab="Age en années")
t<-table(AVC$AGE)
barplot(t,main="AVC - Répartition des ages")
t<-table(AVC$SEXE,AVC$AGE)
barplot(t,col=c("darkblue","white","red"),legend=TRUE)
barplot(t,col=c("yellow","red"),legend=TRUE,beside=TRUE)
```
Etude AIT
---------
Recommandations pour la sélection des données PMSI MCO concernant l’AVC (Juin 2009)
- G450 Syndrome vertébro-basilaire
- G451 Syndrome carotidien (hémisphérique)
- G452 Accident ischémique transitoire de territoires artériels précérébraux multiples et bilatéraux
- G453  Amaurose fugace
- G458  Autres accidents ischémiques cérébraux transitoires et syndromes apparentés
- G459  Accident ischémique cérébral transitoire, sans précision  
```{r ait}
ait<-dpr$DP[substr(dpr$DP,1,3)=="G45" & substr(dpr$DP,1,4)!="G454"]
tab1(ait,missing=FALSE)
```