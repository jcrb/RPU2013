RPU 2013 Analyse
========================================================
```{r date}
date()
```
source: RPU2013
Ce document exploite le fichier RData préparé à partir de la table *RPU__* de Sagec. Voir le document *RPU_2013_Preparation.Rmd* du dossier Resural.

Librairies nécessaires:
-----------------------
```{r library , message=FALSE}
library("gdata")
library("rgrs")
library("lubridate")
library("rattle")
library("epicalc")
library("zoo")
library("xts")
library("xtable")
library("plotrix")
library("openintro")
```
Activité régionale
-----------------------------
```{r routines}
source("../../mes_fonctions.R")
```
Variables globales:
-------------------
```{r var_globales}
mois_courant<-8
annee_couranre<-2013
path<-"../../"
```

Lecture du fichier des données
---------------------------------------
On lit le fichier de travail créé:
```{r Lecture fichier}

if(!exists("d1")) {
load(paste(path,"rpu2013d0108.Rda",sep=""))
d1<-d0108
rm(d0108)
}
d1<-d1[d1$ENTREE<"2013-09-01",]

e<-as.Date(d1$ENTREE)
q<-tapply(e,yday(e),length)
plot(q,type="l")

z<-zoo(q,unique(as.Date(d1$ENTREE)))
plot(z)
plot(xts(z))
lines(rollmean(xts(z), 7),col="red")
```
Variables:
- *e* vecteur contenant les dates d'entrées depuis le début de l'année
- *q* vecteur contenant le nombre d'entrées par jour depuis le début de l'année
- *q2* vecteur contenant le nombre de retours à domiciles par jour
- *q3* vecteur contenant la proportion de retours à domicile par rapport au nombre d'entrées, par jour (taux)
- *q4* vecteur contenant le nombre de retours à domiciles par jour en excluant les non réponses (NA)
- *q5* vecteur contenant la proportion de retours à domicile par rapport au nombre d'entrées, par jour (taux), en excluant les non réponses (NA)
- *q6* taux de non réponses
- *q7* vecteur contenant le taux d'hospitalisation par jour (miroir de q5)

Retour à domicile
-----------------
Les variation du retour journalier à domicile sont calculés de la manière suivante:
- numérateur = somme quotidienne où MODE_SOTIE == Domicile
- dénominateur = somme quotidienne des ENTREE (correspod à q)
```{r retour_dom}
q2<-tapply(d1[d1$MODE_SORTIE=="Domicile",6],yday(d1[d1$MODE_SORTIE == "Domicile", 6]),length)
head(q2)
q3<-q2/q
summary(q3)
plot(q3,type="l")
```
On refait le calcul de q en tenant compte des non réponses:
```{r sauf_na}
q4<-tapply(d1[!is.na(d1$MODE_SORTIE),6],yday(d1[!is.na(d1$MODE_SORTIE), 6]),length)
head(q4)
q5<-q2/q4
head(q5)
summary(q5)
plot(q5,type="l",main="Taux de retour à domicile\n(non réponses exclues)",ylab="Fréquence",xlab="Jours")

z <- zoo(q5, unique(as.Date(d1$ENTREE)))
plot(z,main="Taux de retour à domicile\n(non réponses exclues)",ylab="Fréquence",xlab="Période (moyenne lissée sur 7 jours")
plot(xts(z))
lines(rollmean(xts(z), 7), col = "red",lwd=2)
```
Taux d'hospitalisation
----------------------
c'est le complément (miroir) du précédent:
```{r}
q7<-1-q2/q4
head(q7)
summary(q7)
z <- zoo(q7, unique(as.Date(d1$ENTREE)))
plot(xts(z),main="Taux d'hospitalisation\n(non réponses exclues)",ylab="Fréquence",xlab="Période (moyenne lissée sur 7 jours")
lines(rollmean(xts(z), 7), col = "blue",lwd=2)
```

Taux de non réponses:
```{r non_rep}
q6<-q4/q
head(q6)
summary(q6)
```
Clinique Saint-Luc Schirmeck
============================

- FINESS géographique: N° FINESS :  67 079 863 6
- FINESS juridique:    67 001 460 4
- adresse: 10 RUE DES FORGES 67130 SCHIRMECK
- Tél : 03 88 97 05 70 

resume<-function (x)
{
  name=c("moyenne","écart-type","médiane","min","max","n")
	m<-mean(x,na.remove=TRUE)
	e<-sd(x)
	r<-matrix(c(m,e,median(x),min(x),max(x),length(x)),1,6)
	colnames(r)<-name
	return(r)
}